version: "3"
services:

    guacd:
        image: glyptodon/guacd
        restart: always
        environment:
            ACCEPT_EULA: Y

    db:
        image: glyptodon/guacamole-db-mysql
        restart: always
        environment:
            ACCEPT_EULA: Y
            MYSQL_RANDOM_ROOT_PASSWORD: "yes"
            GUACAMOLE_DATABASE: guacamole_db
            GUACAMOLE_USERNAME: guacamole_user
            GUACAMOLE_PASSWORD: netskope
        volumes:
            - guacamole_database:/var/lib/mysql


    guacamole:
        image: glyptodon/guacamole
        restart: always
        environment:
            ACCEPT_EULA: Y
            GUACD_HOSTNAME: guacd
            MYSQL_HOSTNAME: db
            MYSQL_DATABASE: guacamole_db
            MYSQL_USERNAME: guacamole_user
            MYSQL_PASSWORD: netskope
    ssl:
        image: glyptodon/guacamole-ssl-nginx
        restart: always
        ports:
            - "80:80"
            - "443:443"
        environment:
            ACCEPT_EULA: Y
            GUACAMOLE_HOSTNAME: guacamole
            SSL_HOSTNAME: guacamole.${env}.sselab.eu
            LETSENCRYPT_ACCEPT_TOS: Y
            LETSENCRYPT_STAGING: N
            LETSENCRYPT_EMAIL: dummy@gmail.com
volumes:
    guacamole_database: